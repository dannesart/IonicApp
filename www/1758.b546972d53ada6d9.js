"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1758],{1758:(G,h,i)=>{i.r(h),i.d(h,{SendModule:()=>E});var Z=i(7273),l=i(9102),f=i(5861),C=i(4666),S=i(6308),u=i(591),b=i(4853),T=i(791),k=i(4961),w=i(6528),n=i(6353),A=i(9450),m=i(5586),_=i(6895),$=i(2593);function M(t,a){1&t&&n._UZ(0,"ion-progress-bar",18)}function J(t,a){if(1&t&&(n.TgZ(0,"ion-note",19),n._uU(1),n.qZA()),2&t){const e=n.oxw(2);n.xp6(1),n.hij(" ",e.errorObj.recipient," ")}}function N(t,a){if(1&t){const e=n.EpF();n.TgZ(0,"ion-chip",20),n.NdJ("click",function(){const c=n.CHM(e).$implicit,d=n.oxw(2);return n.KtG(d.pickFavorite(c))}),n._uU(1),n.qZA()}if(2&t){const e=a.$implicit;n.Q6J("outline",!0),n.xp6(1),n.hij(" ",e.firstName," ")}}function L(t,a){if(1&t&&(n.TgZ(0,"ion-note",19),n._uU(1),n.qZA()),2&t){const e=n.oxw(2);n.xp6(1),n.hij(" ",e.errorObj.amount," ")}}function O(t,a){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"ion-header",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.goBack())}),n._UZ(5,"ion-icon",4),n.qZA()(),n.TgZ(6,"ion-title",5),n._uU(7," Send money "),n.qZA()()(),n.TgZ(8,"ion-content",6),n.YNc(9,M,1,0,"ion-progress-bar",7),n.ALo(10,"async"),n.TgZ(11,"div",8)(12,"ion-row",9)(13,"ion-col")(14,"p-input",10),n.NdJ("countryChange",function(r){n.CHM(e);const c=n.oxw();return n.KtG(c.updateCountry(r))})("valueChange",function(r){n.CHM(e);const c=n.oxw();return n.KtG(c.updateValue(r,"recipient"))}),n.ALo(15,"async"),n.qZA(),n.YNc(16,J,2,1,"ion-note",11),n.TgZ(17,"div",12),n.YNc(18,N,2,2,"ion-chip",13),n.qZA()()(),n.TgZ(19,"ion-row",9)(20,"ion-col")(21,"p-input",14),n.NdJ("valueChange",function(r){n.CHM(e);const c=n.oxw();return n.KtG(c.updateValue(r,"amount"))}),n.ALo(22,"async"),n.qZA(),n.YNc(23,L,2,1,"ion-note",11),n.qZA()(),n.TgZ(24,"ion-row",9)(25,"ion-col")(26,"p-input",15),n.NdJ("valueChange",function(r){n.CHM(e);const c=n.oxw();return n.KtG(c.updateValue(r,"message"))}),n.ALo(27,"async"),n.qZA()()()()(),n.TgZ(28,"ion-footer",16)(29,"ion-button",17),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.sendMoney())}),n._uU(30,"Send"),n.qZA()(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(8),n.Q6J("fullscreen",!0),n.xp6(1),n.Q6J("ngIf",n.lcZ(10,21,e.isLoading$)),n.xp6(5),n.Q6J("label","Recipient")("value",n.lcZ(15,23,e.recipientValue$))("type","phone")("country",e.country)("clearInput",!0)("placeholder","Phone number"),n.xp6(2),n.Q6J("ngIf",e.errorObj.recipient),n.xp6(2),n.Q6J("ngForOf",e.usersService.getFavoriteContacts()),n.xp6(3),n.Q6J("label","Amount")("value",n.lcZ(22,25,e.amount$))("type","number")("placeholder","Amount")("clearInput",!0),n.xp6(2),n.Q6J("ngIf",e.errorObj.amount),n.xp6(3),n.Q6J("label","Message")("value",n.lcZ(27,27,e.message$))("type","text")("clearInput",!0)("placeholder","Text message")}}function I(t,a){1&t&&n._UZ(0,"ion-progress-bar",18)}const v=function(){return["/wallet"]};function U(t,a){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"ion-header",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.returnToSendMoneyView())}),n._UZ(5,"ion-icon",4),n.qZA()(),n.TgZ(6,"ion-title",5),n._uU(7," Send money "),n.qZA()()(),n.TgZ(8,"ion-content",6),n.YNc(9,I,1,0,"ion-progress-bar",7),n.ALo(10,"async"),n.TgZ(11,"div",21)(12,"div",22),n._uU(13," Transaction Failed !! "),n.qZA(),n.TgZ(14,"ion-button",23),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.sendMoney())}),n._uU(15,"Retry"),n.qZA(),n.TgZ(16,"ion-button",24),n._uU(17," Cancel "),n.qZA()()(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(8),n.Q6J("fullscreen",!0),n.xp6(1),n.Q6J("ngIf",n.lcZ(10,3,e.isLoading$)),n.xp6(7),n.Q6J("routerLink",n.DdM(5,v))}}function Q(t,a){if(1&t&&(n.TgZ(0,"p",32),n._uU(1),n.ALo(2,"currency"),n.ALo(3,"async"),n.ALo(4,"async"),n.qZA()),2&t){const e=a.ngIf,o=n.oxw(2);n.xp6(1),n.lnq(" ",n.xi3(2,3,n.lcZ(3,6,o.amount$),n.lcZ(4,8,o.currency$))," to ",e.firstName||"Anon"," ",e.lastName," ")}}function j(t,a){if(1&t){const e=n.EpF();n.ynx(0),n.TgZ(1,"ion-header",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),n.NdJ("click",function(){n.CHM(e);const r=n.oxw();return n.KtG(r.returnToSendMoneyView())}),n._UZ(5,"ion-icon",4),n.qZA()(),n.TgZ(6,"ion-title",5),n._uU(7," Send money "),n.qZA()()(),n.TgZ(8,"ion-content",6)(9,"div",21)(10,"div",25),n.O4$(),n.TgZ(11,"svg",26),n._UZ(12,"path",27)(13,"path",28),n.qZA()(),n.kcU(),n.TgZ(14,"p",29),n._uU(15,"Transaction completed"),n.qZA(),n.YNc(16,Q,5,10,"p",30),n.ALo(17,"async"),n.qZA()(),n.TgZ(18,"ion-footer",16)(19,"ion-button",31),n._uU(20," Back to Wallet "),n.qZA()(),n.BQk()}if(2&t){const e=n.oxw();n.xp6(8),n.Q6J("fullscreen",!0),n.xp6(8),n.Q6J("ngIf",n.lcZ(17,3,e.recipientLookup$)),n.xp6(3),n.Q6J("routerLink",n.DdM(5,v))}}const B=[{path:"",component:(()=>{class t{constructor(e,o,r,c,d,y){var p=this;this.wallet=e,this.transaction=o,this.auth=r,this.page=c,this.usersService=d,this.router=y,this.recipient$=new u.X(null),this.recipientValue$=new u.X(null),this.amount$=new u.X(null),this.message$=new u.X(null),this.recipientLookup$=new u.X(null),this.isError$=new u.X(!1),this.isLoading$=new u.X(!1),this.isSuccess$=new u.X(!1),this.currency$=new u.X("EUR"),this.user$=this.usersService.user$,this.errorObj={},this.userBalance=0,this.returnToSendMoneyView=()=>{this.isSuccess$.next(!1),this.isError$.next(!1),this.errorObj={}},this.goBack=()=>{this.router.navigateByUrl(w.H5.wallet)},this.pickFavorite=function(){var g=(0,f.Z)(function*(s){p.country=s.country,p.recipientValue$.next(s.mobilePhone),p.recipient$.next(s.mobilePhone),p.errorObj.recipient=null});return function(s){return g.apply(this,arguments)}}(),this.updateCountry=function(){var g=(0,f.Z)(function*(s){p.country=s.value||s});return function(s){return g.apply(this,arguments)}}(),this.updateValue=function(){var g=(0,f.Z)(function*(s,x){"recipient"===x&&p.recipient$.next(s.value||s.target.value),"amount"===x&&p.amount$.next(s.value||s.target.value),"message"===x&&p.message$.next(s.value||s.target.value)});return function(s,x){return g.apply(this,arguments)}}(),e.getWallet$().subscribe(g=>{this.userBalance=g.balance||0})}sendMoney(){var e=this;return(0,f.Z)(function*(){const o=e.recipient$.value,r=e.user$.value.mobilePhone;try{if(!(0,T.k)(o))throw Error(JSON.stringify({recipient:"Invalid Phone Number"}));if(r===o)throw Error(JSON.stringify({recipient:"You can't send money to yourself"}));const c=+e.amount$.value;if(!c)throw Error(JSON.stringify({amount:"Invalid Amount"}));if(e.userBalance<c)throw Error(JSON.stringify({amount:"Insufficient Amount"}));e.isLoading$.next(!0);const d=yield e.usersService.getRecipientBasedOnPhone(o);if(!d)throw Error(JSON.stringify({amount:"No user found"}));e.recipientLookup$.next(d),yield e.transaction.sendMoney(d.mobilePhone,c,e.message$.value),e.isLoading$.next(!1),e.isSuccess$.next(!0),setTimeout((0,f.Z)(function*(){yield e.wallet.triggerFetch()}),1e4)}catch(c){e.isLoading$.next(!1),c.status?e.isError$.next(!0):(e.errorObj=JSON.parse(c.message),console.log(e.errorObj))}})()}ngOnInit(){return(0,f.Z)(function*(){})()}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(b.X),n.Y36(C.p),n.Y36(S.e),n.Y36(A.P),n.Y36(k.f),n.Y36(m.F0))},t.\u0275cmp=n.Xpm({type:t,selectors:[["route-send"]],decls:8,vars:13,consts:[[4,"ngIf"],["no-border","",1,"ion-no-border","p-2.5"],["slot","start"],[1,"text-xs",3,"click"],["name","arrow-back-outline",1,"text-black"],["color","dark",1,"ion-text-center","text-base","text-black"],[3,"fullscreen"],["type","indeterminate",4,"ngIf"],[1,"h-full","p-8"],[1,"w-full","mb-4"],[1,"w-full",3,"label","value","type","country","clearInput","placeholder","countryChange","valueChange"],["color","danger",4,"ngIf"],[1,"w-full","overflow-x-scroll","flex","flex-row","snap-x","mt-3"],["class","inline-flex flex-none rounded-full border-[1px] border-dark-default",3,"outline","click",4,"ngFor","ngForOf"],[1,"w-full",3,"label","value","type","placeholder","clearInput","valueChange"],[1,"w-full",3,"label","value","type","clearInput","placeholder","valueChange"],[1,"p-8"],["expand","block",3,"click"],["type","indeterminate"],["color","danger"],[1,"inline-flex","flex-none","rounded-full","border-[1px]","border-dark-default",3,"outline","click"],[1,"flex","flex-col","h-full","items-center","justify-center","p-8"],[1,"text-danger-shade","text-2xl","text-center"],["expand","block",1,"w-full",3,"click"],["expand","block","routerDirection","back",1,"w-full",3,"routerLink"],[1,"svg","mb-10"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2",1,"h-6","w-6","stroke-success-shade","scale-[5]","mb-10","mx-auto"],["fill","none","stroke-linecap","round","stroke-linejoin","round","d","M7.83 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z",1,"svg-line"],["fill","none","stroke-linecap","round","stroke-linejoin","round","d","M9 12l2 2 4-4M7.835",1,"svg-check"],[1,"text-sm","text-medium-default"],["class","text-2xl mt-4",4,"ngIf"],["expand","block","routerDirection","back",3,"routerLink"],[1,"text-2xl","mt-4"]],template:function(e,o){1&e&&(n.YNc(0,O,31,29,"ng-container",0),n.ALo(1,"async"),n.ALo(2,"async"),n.YNc(3,U,18,6,"ng-container",0),n.ALo(4,"async"),n.ALo(5,"async"),n.YNc(6,j,21,6,"ng-container",0),n.ALo(7,"async")),2&e&&(n.Q6J("ngIf",!n.lcZ(1,3,o.isError$)&&!n.lcZ(2,5,o.isSuccess$)),n.xp6(3),n.Q6J("ngIf",n.lcZ(4,7,o.isError$)&&!n.lcZ(5,9,o.isSuccess$)),n.xp6(3),n.Q6J("ngIf",n.lcZ(7,11,o.isSuccess$)))},dependencies:[_.sg,_.O5,m.rH,l.YG,l.Sm,l.hM,l.wI,l.W2,l.fr,l.Gu,l.gu,l.uN,l.X7,l.Nd,l.wd,l.sr,l.YI,$.a,_.Ov,_.H9],styles:["[_ngcontent-%COMP%]:root{--backdrop-opacity: 1}.svg[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke-dasharray:1000;stroke-dashoffset:1000;pointer-events:none;animation:firstAnimation 6s linear forwards}.svg[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   .svg-check[_ngcontent-%COMP%]{transform:scale(0);transform-origin:center;animation:appear .1s linear forwards;animation-delay:.5s}@keyframes firstAnimation{to{stroke-dashoffset:0}}@keyframes appear{to{transform:scale(1)}}"]}),t})()}];let Y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[m.Bz.forChild(B),m.Bz]}),t})();var F=i(5892),P=i(6530);let E=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[_.ez,Y,l.Pc,F.A,P.A,m.Bz,Z.g]}),t})()}}]);